Владимир, доброе утро!
Во вложении документация по работе с выгрузкой расписания для вашего
разработчика и пример выгрузки. Выгрузка делается на все филиалы в вашей
базе на один ключ API. Программист подготовил для вас копию рабочей
программы, с которой будет выдаваться расписание для тестирования.
Работа с выгрузкой устроена следующим образом:
- выгрузка сделана не общей, а в пределах каждого выгружаемого
подразделения. Поэтому флаг "full_schedule" также добавлен в объекты
подразделений subdivisions. Если есть хоть одно подразделение с
частичной выгрузкой, то флаг full_schedule в корне будет тоже с
признаком "частичное" (false). Это описано в новой версии в документации
(во вложении).
- полная выгрузка доступна:
                         - при первом запросе за сутки, если ранее такая
выгрузка не делалась (на смене суток по крону будет выгружаться в 00:00);
                         - при архивации/удалении/возвращении
пользователя из архива;
                         - добавляются/отключаются места работы для
пользователя, это ведет к полной выгрузке для подразделения
- частичная - только по измененному расписанию доктора, когда изменения
связаны с записью пациента (при событиях - запись/перенос времени/отмена
записи) или с изменением настройки самого расписания (график работы в
пределах действующего места работы - добавление/удаление рабочих дней,
изменение часов приема).

Инициатором выгрузки расписания будет выступать наша программа. Поэтому
от вас ждем адрес (url), куда будем выгружать расписание, без него
нельзя воспользоваться указанной ссылкой для тестирования запуска
выгрузки
https://selenda24.ru/my_clinic/test/api/test_send_doct_sched_events_api.php?key=mykeyapi

По этой ссылке можно сразу однократно получить расписание для просмотра
примера выгрузки, не дожидаясь отправки с нашей стороны
https://selenda24.ru/npcud_test_api/api.php?cmd=doct_schedule&key=f611d62ad56645d4bf4a897a799ef7f6
Обращаем внимание, что расписание по этой ссылке выдается только один
раз, если нет изменений выдача не происходит. Чтобы получить его еще раз
по этой ссылке, вам нужно написать нам запрос, чтобы мы внесли изменение
в расписание на тестовой базе.

На всякий случай прописываю требования к обмену данными между МИС и сайтом:
1. Прием выгружаемого нами расписания должен быть реализован БЕЗ запроса
с вашей стороны. На указанный вами URL скрипта расписание будет
выгружаться автоматически. Скрипт должен его мгновенно разбирать.
Выгружаемое расписание будет содержать изменения как самого графика
работы, так и занятые/свободные ячейки у докторов. Это важно потому, что
при подачи заявки с сайта, даже без подтверждения сотрудником
регистратуры во вкладке "События" самого предзаказа, он все равно
забронирует ячейки в сетке расписания. Это будет видно в ответе МИС на
запрос записи (т.е. время, занятое предзаказом, сразу будет числится как
занятое время). Если этот предзаказ подтвердит сотрудник регистратуры,
то изменения в сетке не будет, т.к. ячейка все равно останется занятой.
Если сотрудник регистратуры изменит предзаказ (например, удлинит время
приема или перенесет на другого специалиста, если запись к выбранному
врачу не возможна), то МИС мгновенно выгрузит обновленное расписание,
где ячейка свободна и в нее сможет записаться другой пациент (мгновенная
выгрузка со стороны МИС заработает на рабочей базе, для тестовой базы
необходимо использовать ручной вызов выгрузки расписания по команде
test_send_doct_sched_events_api.php).
2. Форма записи на прием на сайте должна содержать все необходимые поля
(все поля обязательны для заполнения, проверка должна делаться на
стороне сайта, а не нашего сервера). Перечень полей указан в техническом
задании. Полнота заполнения ФИО не требуется, но приветствуется, т.к.
позволяет программе производить поиск пациентов в МИС, что упрощает
работу администратору, который будет подтверждать предзаказ. Дата
рождения пациента должна быть реальной, а не подставляемой генератором
случайных чисел. Номер мобильного телефона должен вводиться по маске,
чтобы сразу корректно передаваться в заявке (формат передачи номера
указан в техническом задании).
3. Тестирование интеграции должно производиться так:
- в админке сайта заполняются идентификаторы нескольких врачей/мест
работы/филиалов;
- в МИС для этих врачей на указанных местах работы настраиваются рабочие
дни. Делается эмуляция выгрузки расписания кроном по команде
test_send_doct_sched_events_api.php (проверяется корректность
отображенных данных на сайте клиники). Процедура повторяется несколько
раз с добавлением в выгрузку новых врачей, с отключением мест работы,
филиалов в настройках пользователя, снятием рабочих дней в графике работы;
- при успешной реализации предыдущего этапа через сайт направляются
запросы на запись на прием. Процедура повторяется несколько раз с
подтверждением/отменой предзаказа во вкладке "События". Для
аннулированных предзаказов обязателен вызов команды
test_send_doct_sched_events_api.php, чтобы сайт увидел, что
забронированная ячейка расписания свободна.
Если выгружаемое расписание работает корректно, можно считать процесс
тестирования завершенным.
После этого необходимо сделать нам письменный запрос на то, что вы
готовы работать с записью на прием в рабочей базе. Наш программист
произведет все необходимые настройки. После этого можно начинать
обучение сотрудников.

Если будут вопросы, пишите на мой e-mail, скайп (olya_malinka174),
WhatsApp или Telegram. Я передам программисту и перенаправлю вам его ответы.

-- 
С уважением,
Ольга Исаченко,
специалист технической поддержки МИС Селенда
+7 (925) 155-33-01
+7 (499) 110-53-79